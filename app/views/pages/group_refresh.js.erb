// refresh sidebar
$("#group_list").html("<%= escape_javascript(render partial: 'pages/group_list') %>");

// refresh selected group
var selected_group = $('.selected-group').attr('gid');
if(selected_group != "-1"){
    $.ajax({
        url: "<%= single_group_html_path %>",
        dataType : "script",
        cache: true,
        method: "post",
        data: {
            group_id: selected_group
        }
    });
}


// close modal if needed
<% if defined?(close) %>
$(".modal").modal("close");
<% end %>

// remove deleted groups from view
<% if defined?(delete) %>
$("#box_" + <%= delete %>).fadeOut(400);
$("#box_" + <%= delete %>).addClass("hidden");
$("#box_" + <%= delete %>).appendTo("#group_tables");
$("#box_" + <%= delete %>).promise().done(function(){
    // Show placeholder if all groups are hidden
    if ($(".group-box").filter(".hidden").length == $(".group-box").length) {
        $("#group-placeholder").removeClass("hidden");
        $("#box_" + <%= delete %>).remove();
    }
});

<% end %>

<% if message != "empty" %>
    <%= render(:template => 'pages/notify', :handlers => [:erb], :formats => [:js], locals:{message: message, type: type}) %>
<% end %>
